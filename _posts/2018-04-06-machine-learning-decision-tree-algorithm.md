---
layout: post
title: 机器学习算法之决策树算法
date: 2018-04-05 21:40:00
tags: [机器学习, 决策树算法]
---

## 定义

决策树是一种典型的分类方法, 首先我们对数据进行整理，利用归纳算法生成可读的规则, 然后利用生成的规则对未知数据进行预测。本质上来说决策树就是利用一些规则对数据进行分类的过程。

## 决策树相关算法

1. Hunt，Marin 和 Stone于1996年提出的CLS学习系统, 用于学习单个概念
2. 1979年, J.R.Quinlan提出的ID3算法, 并对ID3进行总结和简化使得ID3算法成为决策树算法中的典型
3. 1988年, Utgoff在ID4的基础上提出了ID5算法, 进一步提高了决策树的效率
4. 1993年 Quinlan进一步改进了ID3算法, 改进成了C4.5算法
5. 另一类决策算法为CART

## ID3算法

在本章中, 我们先了解一下ID3算法是如何进行的, ID3算法是针对于属性选择问题, 是决策树中最具影响力和最为典型的算法。该方法使用信息增益的方式进行节点的选择.

那么信息增益应该怎么算呢? 在了解信息增益如何计算之前, 我们还需要引入另外一个基本概念叫做信息熵. 熵定义为信息的期望值. 我们通过如下公式来计算熵:

![香农熵计算公式](/assets/images/2018-04-05-machine-learning-entropy.png)

对于在某一个特征上的信息增益如何计算呢?

    Gain(A) = Info(D) - Info_A(D)

Info(D)表示在训练数据D集合信息熵, Info_A(D)表示在已知特征A的情况下的D集合信息熵. 这种表示确实不是一般人能理解的。
变量的不确定性越高, 信息熵越大, 而反过来如果变量的不确定性越低, 信息熵越小. 那么如果以A变量来划分数据, 如果A的确定性越高, 其在数据集上计算出来的熵越小, 那么其信息增益越大. 其实归根结底就是找能够使得分类更明确的特征。

下面我们用一个很简答的例子来说明如何计算一个特征在整个集合上的信息增益

| ID  |年龄    | 收入  | 学生 | 信誉| 是否购买电脑  |
| -   |-----  | ----  | ----| -: | :----: |
| 1   |青年    | 高    | 否  | 良  |  否  |
| 2   |青年    | 高    | 否  | 优  |  否  |
| 3   |中年    | 高    | 否  | 良  |  是  |
| 4   |老年    | 中    | 否  | 良  |  是  |
| 5   |老年    | 低    | 是  | 良  |  是  |
| 6   |老年    | 低    | 是  | 优  |  否  |
| 7   |中年    | 低    | 是  | 优  |  是  |
| 8   |青年    | 中    | 否  | 良  |  否  |
| 9   |青年    | 低    | 是  | 良  |  是  |

首先, 我们要选择一个特征作为决策树的根节点。当然我们首先要知道在不使用任何特征的前提下, 该数据集上的信息熵为多少?

根据是否购买的情况，利用上面我们给出的公式我们知道

![原始数据的信息熵](/assets/images/2018-04-05-machine-learning-info-d.png)

其中, 因为没有考虑任何的特征, 我们知道在原始数据中, 买电脑的占 5/9 而不买电脑的人占总数的 4/9. 所以得到了上面的数据。

随后我们根据年龄将数据切分为三部分： 青年, 中年, 老年

| ID  |年龄    | 收入  | 学生 | 信誉| 是否购买电脑  |
| -   |-----  | ----  | ----| -: | :----: |
| 1   |青年    | 高    | 否  | 良  |  否  |
| 2   |青年    | 高    | 否  | 优  |  否  |
| 8   |青年    | 中    | 否  | 良  |  否  |
| 9   |青年    | 低    | 是  | 良  |  是  |

| ID  |年龄    | 收入  | 学生 | 信誉| 是否购买电脑  |
| -   |-----  | ----  | ----| -: | :----: |
| 3   |中年    | 高    | 否  | 良  |  是  |
| 7   |中年    | 低    | 是  | 优  |  是  |

| ID  |年龄    | 收入  | 学生 | 信誉| 是否购买电脑  |
| -   |-----  | ----  | ----| -: | :----: |
| 4   |老年    | 中    | 否  | 良  |  是  |
| 5   |老年    | 低    | 是  | 良  |  是  |
| 6   |老年    | 低    | 是  | 优  |  否  |

同样, 我们依据上面的公式可以有如下推理过程:

![以年龄来分类计算得出的信息熵](/assets/images/2018-04-05-machine-learning-info-a.png)

这样我们就知道了年龄这个特征的信息增益为: `0.66`
